<html>
	<head>
		<title>Baseless example</title>
		<script src="https://cdn.tailwindcss.com/3.0.0"></script>
		<script>
			tailwind.config = {
				theme: {
					extend: {
						colors: {
							baseless: {
								DEFAULT: "#3DC3CC",
								50: "#CEF0F2",
								100: "#BEEBEE",
								200: "#9EE1E5",
								300: "#7ED7DD",
								400: "#5DCDD4",
								500: "#3DC3CC",
								600: "#2B9EA5",
								700: "#207379",
								800: "#14494D",
								900: "#081F20",
							},
						},
					},
				},
			};
		</script>
		<script type="importmap">
			{
				"imports": {
					"https://baseless.dev/x/client@next/": "http://localhost:8081/client/"
				}
			}
		</script>
		<script defer type="module">
			import { initializeApp } from "https://baseless.dev/x/client@next/browser/app.js";
			import {
				getAuth,
				createUserWithEmailAndPassword,
				validateEmail,
				resetPassword,
				signInWithEmailAndPassword,
				setPersistence,
				Persistence,
			} from "https://baseless.dev/x/client@next/browser/auth.js";

			const app = await initializeApp({
				baselessUrl: "http://localhost:8787/",
				clientId: "hello-world",
				clientPublicKey:
					"-----BEGIN PUBLIC KEY-----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAvYSmNTflBIr2Q2z/oVSR+SfhSfelM+ZL/wb+4LenIaRSLdNm8JGD5TI4i1n3qRyPTxbqa70n4Jwx9H8hLMs/qYml0wCEAmrAqqXixku4gz6TtO25D8cXPlquCfNVRO2Dt7CK4ZCUgwVizqJC6+ZIM6fiTI4/rIU6SRb/ZClHuaGspYx4BVW+2AxgzckaojNosiof/7oac4WZck109jCEVE201E8YUumSZtkAxuzFnzPYFKyK4hztpZScSLvvM4Cty7LkwzZLuTkFXgspJ3SzFa6WR9vLleL4GmMBe0Cq8NU8DhdrNgkAt0Ngksf4mFaTpS4p+bKFEdwchVTUzRKlLQIDAQAB-----END PUBLIC KEY-----",
				clientPublicKeyAlg: "RS256",
			});

			const auth = getAuth(app);

			const loginForm = document.querySelector("#login");
			const registerForm = document.querySelector("#register");
			const validateForm = document.querySelector("#validate");
			const pwresetForm = document.querySelector("#pwreset");
			const params = new URLSearchParams(window.location.search);
			const action = params.get("action");

			function goto(section) {
				if (section === "signin") {
					loginForm.style.display = "block";
					registerForm.style.display = "none";
					validateForm.style.display = "none";
					pwresetForm.style.display = "none";
				} else if (section === "register") {
					loginForm.style.display = "none";
					registerForm.style.display = "block";
					validateForm.style.display = "none";
					pwresetForm.style.display = "none";
				} else if (section === "validate") {
					registerForm.style.display = "none";
					loginForm.style.display = "none";
					validateForm.style.display = "block";
					pwresetForm.style.display = "none";
				} else if (section === "pwreset") {
					registerForm.style.display = "none";
					loginForm.style.display = "none";
					validateForm.style.display = "none";
					pwresetForm.style.display = "block";
				}
			}

			registerForm.addEventListener("submit", async (e) => {
				e.preventDefault();
				const email = registerForm.querySelector("[name=email]");
				const password = registerForm.querySelector("[name=password]");

				const result = await createUserWithEmailAndPassword(auth, email.value, password.value);
				console.log(result);
			});

			loginForm.addEventListener("submit", async (e) => {
				e.preventDefault();
				const email = loginForm.querySelector("[name=email]");
				const password = loginForm.querySelector("[name=password]");
				const rememberMe = loginForm.querySelector("[name=remember-me]");

				await setPersistence(auth, rememberMe ? Persistence.Local : Persistence.Session);

				const result = await signInWithEmailAndPassword(auth, email.value, password.value);
				console.log(result);
			});

			validateForm.addEventListener("submit", async (e) => {
				e.preventDefault();
				const email = params.get("email");
				const code = params.get("code");

				const result = await validateEmail(auth, code, email);
				console.log(result);
				debugger;
			});

			pwresetForm.addEventListener("submit", async (e) => {
				e.preventDefault();
				const email = params.get("email");
				const code = params.get("code");
				const newPassword = pwresetForm.querySelector("[name=new-password]");

				const result = await resetPassword(auth, email, code, newPassword);
				console.log(result);
				debugger;
			});

			registerForm.querySelector("[data-role=goto-signin]").addEventListener("click", (e) => {
				e.preventDefault();
				goto("signin");
			});

			loginForm.querySelector("[data-role=goto-register]").addEventListener("click", (e) => {
				e.preventDefault();
				goto("register");
			});

			goto(params.get("action"));
		</script>
	</head>
	<body>
			<div class="min-h-full flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8">
				<div class="max-w-md w-full space-y-8">
					<div>
						<svg
							version="1.1"
							xmlns="http://www.w3.org/2000/svg"
							xmlns:xlink="http://www.w3.org/1999/xlink"
							x="0px"
							y="0px"
							viewBox="0 0 300 300"
							style="enable-background: new 0 0 300 300"
							xml:space="preserve"
							class="mx-auto h-12 w-auto"
						>
							<symbol id="logo_symbol" viewBox="-124.48 0 248.96 321.35">
								<g>
									<g>
										<path
											d="M105.04,188.38c0.38,0.55,0.76,1.09,1.12,1.65c7.65,11.77,11.48,25.97,11.48,42.6c0,28.84-10.78,50.83-32.33,65.99
					c-21.56,15.15-53.01,22.73-94.35,22.73h-115.43V189.57l117.25-28.16L105.04,188.38z M111.02,139.27
					c-0.03,0.04-0.06,0.07-0.09,0.11L-4.24,111.72c-0.98-0.24-1.99-0.35-3-0.35c-1.01,0-2.02,0.12-3,0.35l-114.24,27.44V0H5.96
					C45.1,0.29,74.63,8.35,94.57,24.17c19.94,15.81,29.91,39.47,29.91,70.96C124.48,112.48,119.99,127.2,111.02,139.27z"
										/>
									</g>
								</g>
							</symbol>
							<g id="B">
								<use
									xlink:href="#logo_symbol"
									width="248.96"
									height="321.35"
									x="-124.48"
									transform="matrix(0.78 0 0 -0.78 156 275.3333)"
									style="overflow: visible; fill: #3dc3cc"
								/>
							</g>
						</svg>
					</div>
					<form id="login" class="space-y-6" action="#" method="POST">
						<h2 class="mt-6 text-center text-3xl font-extrabold text-gray-900">Sign in to your account</h2>
						<p class="text-center text-sm text-gray-600">
							Or
							<a href="#" data-role="goto-register" class="font-medium text-baseless hover:text-baseless-700"> start your 14-day free trial </a>
						</p>
						<div>
							<label for="email" class="block text-sm font-medium text-gray-700"> Email address </label>
							<div class="mt-1">
								<input
									name="email"
									type="email"
									autocomplete="email"
									required
									class="appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-baseless-500 focus:border-baseless-500 sm:text-sm"
								/>
							</div>
						</div>

						<div>
							<label for="password" class="block text-sm font-medium text-gray-700"> Password </label>
							<div class="mt-1">
								<input
									name="password"
									type="password"
									autocomplete="current-password"
									required
									class="appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-baseless-500 focus:border-baseless-500 sm:text-sm"
								/>
							</div>
						</div>

						<div class="flex items-center justify-between">
							<div class="flex items-center">
								<input
									name="remember-me"
									type="checkbox"
									class="h-4 w-4 text-baseless-600 focus:ring-baseless-500 border-gray-300 rounded"
								/>
								<label for="remember-me" class="ml-2 block text-sm text-gray-900"> Remember me </label>
							</div>

							<div class="text-sm">
								<a href="#" class="font-medium text-baseless-600 hover:text-baseless-500"> Forgot your password? </a>
							</div>
						</div>

						<div>
							<button
								type="submit"
								class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-baseless-600 hover:bg-baseless-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-baseless-500"
							>
								Sign in
							</button>
						</div>
					</form>
					<form id="register" style="display: none" class="space-y-6" action="#" method="POST">
						<h2 class="mt-6 text-center text-3xl font-extrabold text-gray-900">Register a new account</h2>
						<p class="text-center text-sm text-gray-600">
							Or
							<a href="#" data-role="goto-signin" class="font-medium text-baseless hover:text-baseless-700"> sign in with your email </a>
						</p>

						<div>
							<label for="email" class="block text-sm font-medium text-gray-700"> Email address </label>
							<div class="mt-1">
								<input
									name="email"
									type="email"
									autocomplete="email"
									required
									class="appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-baseless-500 focus:border-baseless-500 sm:text-sm"
								/>
							</div>
						</div>

						<div>
							<label for="password" class="block text-sm font-medium text-gray-700"> Password </label>
							<div class="mt-1">
								<input
									name="password"
									type="password"
									autocomplete="current-password"
									required
									class="appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-baseless-500 focus:border-baseless-500 sm:text-sm"
								/>
							</div>
						</div>

						<div class="flex items-center justify-end">
							<div class="text-sm">
								<a href="#" class="font-medium text-baseless-600 hover:text-baseless-500"> Forgot your password? </a>
							</div>
						</div>

						<div>
							<button
								type="submit"
								class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-baseless-600 hover:bg-baseless-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-baseless-500"
							>
								Register
							</button>
						</div>
					</form>
					<form id="validate" style="display: none" class="space-y-6" action="#" method="POST">
						<h2 class="mt-6 text-center text-3xl font-extrabold text-gray-900">Validate email</h2>

						<div>
							<button
								type="submit"
								class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-baseless-600 hover:bg-baseless-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-baseless-500"
							>
								Validate
							</button>
						</div>
					</form>
					<form id="pwreset" style="display: none" class="space-y-6" action="#" method="POST">
						<h2 class="mt-6 text-center text-3xl font-extrabold text-gray-900">Reset password</h2>

						<div>
							<label for="code" class="block text-sm font-medium text-gray-700"> New password </label>
							<div class="mt-1">
								<input
									name="new-password"
									type="password"
									required
									class="appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-baseless-500 focus:border-baseless-500 sm:text-sm"
								/>
							</div>
						</div>

						<div>
							<button
								type="submit"
								class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-baseless-600 hover:bg-baseless-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-baseless-500"
							>
								Reset password
							</button>
						</div>
					</form>
				</div>
			</div>
		</div>
	</body>
</html>
